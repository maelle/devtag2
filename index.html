<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Restrict Help Files to Development • devtag2</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Restrict Help Files to Development">
<meta name="description" content="Extends the Rd roclet to support creating internal manual pages.">
<meta property="og:description" content="Extends the Rd roclet to support creating internal manual pages.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">devtag2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/maelle/devtag2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="devtag2">devtag2<a class="anchor" aria-label="anchor" href="#devtag2"></a>
</h1></div>
<!-- badges: start -->

<p>The goal of devtag2 is to help you get Rd manual pages for your internal functions, without making those manual pages accessible to users.</p>
<p>When you use devtag2, you use <code>@dev</code> instead of <code>@export</code> for internal functions.</p>
<p>It follows the same principles as its inspiration <a href="https://github.com/moodymudskipper/devtag/" class="external-link">devtag</a> by Antoine Fabri:</p>
<ul>
<li>Manual pages are added to <code>.Rbuildignore</code> so users don’t see them.</li>
<li>Manual pages are <strong>not</strong> added to <code>.gitignore</code> so collaborators see them.</li>
</ul>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of devtag2 like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"maelle/devtag2"</span><span class="op">)</span></span></code></pre></div>
<p>Then in each package where you use devtag2 you need to register its roclet in <code>DESCRIPTION</code>:</p>
<pre><code><span><span class="va">Roxygen</span><span class="op">:</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>markdown <span class="op">=</span> <span class="cn">TRUE</span>, roclets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"collate"</span>, <span class="st">"devtag2::super_rd"</span>, <span class="st">"namespace"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>And you probably should add this line as well, so collaborators know where to get devtag2 from:</p>
<pre><code><span><span class="va">Config</span><span class="op">/</span><span class="va">Needs</span><span class="op">/</span><span class="va">build</span><span class="op">:</span> <span class="va">maelle</span><span class="op">/</span><span class="va">devtag2</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>I added the <code>@dev</code> tag to the documentation of the internal function <code><a href="reference/rbuild_ignore.html">rbuild_ignore()</a></code>. You can see its manual pages in <code>man/rbuild_ignore.Rd</code> in the package source.</p>
</div>
<div class="section level2">
<h2 id="why-a-new-package">Why a new package?!<a class="anchor" aria-label="anchor" href="#why-a-new-package"></a>
</h2>
<p>I was annoyed at devtag’s re-creating the internal manual pages every time <code>devtools::document()</code> was run, even if they hadn’t changed. I wanted to try creating the roclet as an extension of the Rd roclet rather than a brand-new roclet, because I assumed this would prevent the aforementioned annoyance. This is the strategy that was used in <a href="https://github.com/gaborcsardi/roxygenlabs" class="external-link">roxygenlabs</a>, the former incubator of roxygen2’s features. Piggy-backing on the Rd roclet makes the experience nicer and seems more natural to me.</p>
<p>I was also hoping the code would be simpler but I’m not so sure it really is: - The Rbuildignoring needs to happen in the output method where we have access to the filename of the Rd file. But at that stage we no longer have access to tags, only to the contents of the Rd file. - Therefore in the process method I “mark” the block as a dev block by changing its title, adding “Internal function:” before the title. Then in the output method I remove the mark. This feels a bit hacky still!</p>
<p>In my current understanding, to make the implementation of <code>@dev</code> simpler it’d have to live within roxygen2. The <a href="https://github.com/r-lib/roxygen2/blob/main/R/topic.R" class="external-link">RoxyTopic objects</a> would get an “internal” field, that the process method of the Rd roclet would fill, and that the output method of the Rd roclet would use to decide whether to <code>.Rbuildignore</code> a topic.</p>
<p>A drawback to devtag2’s roclet being a roclet to use <strong>instead of</strong> the Rd roclet means you can’t use it in combination with a roclet that also extends the Rd roclet. For instance, this would be problematic in igraph where we use both devtag and <a href="https://github.com/igraph/igraph.r2cdocs/" class="external-link">igraph.r2cdocs</a> that implements an extension of the Rd roclet.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/maelle/devtag2/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/maelle/devtag2/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing devtag2</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Maëlle Salmon <br><small class="roles"> Maintainer, author </small> <a href="https://orcid.org/0000-0002-2815-0399" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://github.com/maelle/devtag2/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/maelle/devtag2/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maëlle Salmon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
